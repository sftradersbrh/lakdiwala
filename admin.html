<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin - S F Traders</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>body{background:#111; color:#eee}</style>
</head>
<body class="p-6">
  <div class="max-w-3xl mx-auto">
    <h1 class="text-2xl font-bold mb-4">S F Traders â€” Admin Panel</h1>

    <div id="authBox" class="mb-6">
      <h2 class="font-semibold">Admin Login</h2>
      <input id="email" placeholder="Email" class="block w-full p-2 mt-2 bg-gray-900 border border-gray-700 rounded" />
      <input id="password" placeholder="Password" type="password" class="block w-full p-2 mt-2 bg-gray-900 border border-gray-700 rounded" />
      <div class="mt-3">
        <button id="loginBtn" class="bg-wood-700 px-4 py-2 rounded">Login</button>
        <button id="logoutBtn" class="bg-gray-700 px-3 py-2 rounded hidden">Logout</button>
      </div>
      <div id="authMsg" class="mt-2 text-sm text-red-400"></div>
    </div>

    <div id="adminArea" style="display:none">
      <h2 class="font-semibold">Upload Images</h2>
      <div class="grid grid-cols-1 gap-3 mt-3">
        <label>Banner image<input id="bannerFile" type="file" class="block mt-1" /></label>
        <label>Jackfruit<input id="jackfruitFile" type="file" class="block mt-1" /></label>
        <label>Sagwan<input id="sagwanFile" type="file" class="block mt-1" /></label>
        <label>Sheesham<input id="sheeshamFile" type="file" class="block mt-1" /></label>
        <label>Eucalyptus<input id="eucalyptusFile" type="file" class="block mt-1" /></label>
        <label>Jamun<input id="jamunFile" type="file" class="block mt-1" /></label>
        <label>Aam (Mango)<input id="aamFile" type="file" class="block mt-1" /></label>
      </div>
      <div class="mt-4">
        <button id="uploadBtn" class="bg-wood-700 px-4 py-2 rounded">Upload Selected</button>
        <div id="uploadMsg" class="mt-2 text-sm"></div>
      </div>
    </div>
  </div>

  <script type="module">
    import initializeApp from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js';
    import {{ getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged }} from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js';
    import {{ getStorage, ref, uploadBytes }} from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-storage.js';

    const firebaseConfig = {"apiKey": "AIzaSyDVDQboS2LzviGSz3D2hlwEvojZGFcvVPA", "authDomain": "sflakdiwala.firebaseapp.com", "projectId": "sflakdiwala", "storageBucket": "sflakdiwala.appspot.com", "messagingSenderId": "21729827773", "appId": "1:21729827773:web:64181ec4b6cdcff544d0d4", "measurementId": "G-W8MV1BW0XJ"};

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const storage = getStorage(app);

    const loginBtn = document.getElementById('loginBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const authMsg = document.getElementById('authMsg');
    const adminArea = document.getElementById('adminArea');

    loginBtn.addEventListener('click', async ()=>{
      const email = document.getElementById('email').value;
      const pass = document.getElementById('password').value;
      try {
        await signInWithEmailAndPassword(auth, email, pass);
      } catch(e){ authMsg.textContent = e.message; }
    });

    logoutBtn.addEventListener('click', async ()=>{ await signOut(auth); });

    onAuthStateChanged(auth, user=>{
      if(user){
        authMsg.textContent = 'Logged in as '+user.email;
        adminArea.style.display = 'block';
        logoutBtn.classList.remove('hidden');
        loginBtn.classList.add('hidden');
      } else {
        authMsg.textContent = '';
        adminArea.style.display = 'none';
        logoutBtn.classList.add('hidden');
        loginBtn.classList.remove('hidden');
      }
    });

    document.getElementById('uploadBtn').addEventListener('click', async ()=>{
      const files = [
        ['banner.jpg', document.getElementById('bannerFile').files[0]],
        ['jackfruit.jpg', document.getElementById('jackfruitFile').files[0]],
        ['sagwan.jpg', document.getElementById('sagwanFile').files[0]],
        ['sheesham.jpg', document.getElementById('sheeshamFile').files[0]],
        ['eucalyptus.jpg', document.getElementById('eucalyptusFile').files[0]],
        ['jamun.jpg', document.getElementById('jamunFile').files[0]],
        ['aam.jpg', document.getElementById('aamFile').files[0]]
      ];
      const uploadMsg = document.getElementById('uploadMsg');
      uploadMsg.textContent = 'Uploading...';
      for(const [name,file] of files){
        if(!file) continue;
        const storageRef = ref(storage, 'images/'+name);
        try{ await uploadBytes(storageRef, file); }
        catch(e){ uploadMsg.textContent = 'Upload failed: '+e.message; return; }
      }
      uploadMsg.textContent = 'Upload complete. Changes will reflect on site shortly.';
    });
  </script>
</body>
</html>
